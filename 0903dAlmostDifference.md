Поддерживаем некоторый map/hashmap с количеством вхождений каждого числа до текущей позиции. Обрабатывая некоторое число, мы вычитаем *a[i] i* раз (*1 - indexed*), прибавляем префиксную сумму до *(i-1)*-го числа, вычитаем `count(a[i]-1) * (a[i]-1)`, `count(a[i]) * ai` и `count(a[i]+1) * (a[i]+1)` и прибавляем `a[i]*count(a[i]-1) + count(a[i]) + count(a[i]+1)` раз. Затем обновляем *count* при помощи *a[i]*.

Асимптотика решения: `O(n*log(n))`